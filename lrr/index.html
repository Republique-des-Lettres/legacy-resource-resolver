<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>République des Lettres: where to find legacy resources</title>
  <style>
    /* GitHub markdown style basics */
    body {
      background: #fff;
      color: #24292f;
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: 40px auto;
      padding: 32px;
      background: #fff;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      box-shadow: 0 1px 0 rgba(27,31,35,0.04);
    }
    h1 {
      font-size: 2em;
      margin-bottom: 1.25em;
      border-bottom: 1px solid #d8dee4;
      padding-bottom: .3em;
      font-weight: 600;
    }
    dl {
      margin: 0 0 24px 0;
      padding: 0;
    }
    dt {
      font-weight: 600;
      background: #f6f8fa;
      padding: 12px 16px;
      margin-top: 0;
      border: 1px solid #d0d7de;
      border-bottom: none;
      cursor: pointer;
      user-select: none;
      border-radius: 6px 6px 0 0;
      transition: background 0.15s;
      outline: none;
      font-size: 1.1em;
    }
    dt:not(:first-child) {
      margin-top: 18px;
    }
    dt.active, dt:focus, dt:hover {
      background: #eaeef2;
    }
    dd {
      border: 1px solid #d0d7de;
      border-top: none;
      padding: 16px 24px;
      margin: 0 0 0 0;
      background: #f6f8fa;
      border-radius: 0 0 6px 6px;
      display: none;
    }
    dd.active { display: block; }
    ul, ol {
      margin: 8px 0 8px 32px;
      padding-left: 0;
    }
    li {
      margin: 4px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      margin-bottom: 8px;
      background: #fff;
    }
    th, td {
      border: 1px solid #d0d7de;
      padding: 6px 13px;
      text-align: left;
    }
    th {
      background: #f6f8fa;
      font-weight: 600;
    }
    a {
      color: #0969da;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    details {
      margin-top: 7em;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      background: #f6f8fa;
      padding: 1em 1.5em;
      font-size: x-small;
    }
    summary {
      font-weight: 600;
      cursor: pointer;
      outline: none;
      margin: -1em -1.5em 1em -1.5em;
      padding: 1em 1.5em;
      background: #eaeef2;
      border-radius: 6px 6px 0 0;
      border-bottom: 1px solid #d0d7de;
      font-size: 1.08em;
    }    
    @media (max-width: 600px) {
      .container {
        padding: 8px;
      }
      dd, dt, details {
        padding-left: 8px;
        padding-right: 8px;
      }
      summary {
        padding-left: 8px;
        padding-right: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>République des Lettres: where to find legacy resources</h1>
    <dl id="legacy-dl">
      <!-- JS will populate these! -->
    </dl>
    <hr/>
    <p><strong><a href="https://republique-des-lettres.ch" target="_blank">République des Lettres (from 2025)</a></strong></p>
    <details>
      <summary>Inspect request</summary>
      <div id="inspect-headers">
        <!-- JS will populate the table here -->
      </div>
    </details>
  </div>
  <script>
    // Legacy resource mapping
    const legacyResources = [
      {
        domain: "albrecht-von-haller.ch",
        label: "albrecht-von-haller.ch",
        html: `
          <p>Most contents of the tri-lingual website "albrecht-von-haller.ch" have been brought over to <a href="https://republique-des-lettres.ch">République des Lettres</a>.</p>
          <p>If you are looking for the original "albrecht-von-haller.ch" page, you will find it here (to facilitate longterm availability, the copy does not retain any database functionalities):</p>
          <table>
            <tr><th>Resource</th><th>New Location</th></tr>
            <tr><td><code>albrecht-von-haller.ch</code> D</td><td><a href="https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/de/index.php" target="_blank">https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/de/index.php</a></td></tr>
            <tr><td><code>albrecht-von-haller.ch</code> E</td><td><a href="https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/e/index.php" target="_blank">https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/e/index.php</a></td></tr>
            <tr><td><code>albrecht-von-haller.ch</code> F</td><td><a href="https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/f/index.php" target="_blank">https://files.hallernet.republique-des-lettres.ch/legacy/albrecht-von-haller.ch/f/index.php</a></td></tr>
          </table>
          <p>Last updated: 2025-06-19</p>
        `
      },      
      {
        domain: "files.hallernet.org",
        label: "files.hallernet.org",
        html: `
          <p>This is the legacy file store of the hallerNet platform. It used to be served from project-owned hardware and was subsequently moved to Github.</p>
          <p><strong>Now available at:</strong></p>
          <ul>
            <li><a href="https://github.com/Republique-des-Lettres/files.hallernet.org" target="_blank"><code>Republique-des-Lettres/files.hallernet.org</code></a> (repository)</li>
            <li><a href="http://republique-des-lettres.github.io/files.hallernet.org" target="_blank"><code>republique-des-lettres.github.io/files.hallernet.org</code></a> (file index)</li>
          </ul>
          <p>Last updated: 2025-06-19</p>
        `
      },
      {
        domain: "haller.unibe.ch",
        label: "haller.unibe.ch",
        html: `
          <p><em>Domain to be configured.</em></p>
        `
      },
      {
        domain: "images.hallernet.org",
        label: "images.hallernet.org",
        html: `
          <p>hallerNet IIIF server</p>
          <p>Initially, the hallerNet platform maintained its own IIIF server (using IIPImage). Following the migration to iiif.ub.unibe.ch the service was discontinued.</p>
          <p>Last updated: 2025-06-19</p>
        `
      },
      {
        domain: "legacy.hallernet.org",
        label: "legacy.hallernet.org",
        html: `
          <p><code>legacy.hallernet.org</code> pointed to the <code>albrecht-von-haller.ch</code> site from ca. 2018-2024 (see above).</p>
        `
      }
    ];

    // Utility: get the domain from a URL
    function extractDomain(url) {
      try {
        return new URL(url).hostname.replace(/^www\./, '');
      } catch {
        return "";
      }
    }

    // Build the definition list dynamically
    function buildList(dl, resources) {
      resources.forEach((res, idx) => {
        const dt = document.createElement('dt');
        dt.textContent = res.label;
        dt.tabIndex = 0; // allow keyboard focus
        dt.dataset.idx = idx;
        dt.id = `legacy-dt-${idx}`;

        const dd = document.createElement('dd');
        dd.innerHTML = res.html;
        dd.id = `legacy-dd-${idx}`;

        dt.addEventListener('click', () => toggle(idx));
        dt.addEventListener('keydown', (e) => {
          if (e.key === "Enter" || e.key === " ") { e.preventDefault(); toggle(idx); }
        });

        dl.appendChild(dt);
        dl.appendChild(dd);
      });
    }

    // Collapse all, then uncollapse one
    function toggle(idx) {
      legacyResources.forEach((_, i) => {
        document.getElementById(`legacy-dd-${i}`).classList.toggle('active', i === idx);
        document.getElementById(`legacy-dt-${i}`).classList.toggle('active', i === idx);
      });
      // Scroll to the active header (for accessibility)
      document.getElementById(`legacy-dt-${idx}`).scrollIntoView({ behavior: "smooth", block: "center" });
    }

    // Show request headers/info accessible from JS
    function renderHeadersTable() {
      // Only headers you can access from browser JS:
      const headers = {
        "Host": location.host,
        "User-Agent": navigator.userAgent,
        "Referer": document.referrer || "(none)",
        "Location (URL)": location.href,
        "Origin": location.origin,
        "Language": navigator.language,
        "Platform": navigator.platform,
        "Cookies enabled": navigator.cookieEnabled ? "Yes" : "No",
        "Do Not Track": navigator.doNotTrack === "1" ? "Yes" : (navigator.doNotTrack === "0" ? "No" : "Unknown")
      };

      let table = '<table><tr><th>Header / Info</th><th>Value</th></tr>';
      for (const [key, value] of Object.entries(headers)) {
        table += `<tr><td>${key}</td><td style="word-break:break-all">${value}</td></tr>`;
      }
      table += '</table>';
      document.getElementById('inspect-headers').innerHTML = table;
    }

    // On load: build the list, auto-expand if matching referrer
    document.addEventListener("DOMContentLoaded", () => {
      const dl = document.getElementById('legacy-dl');
      buildList(dl, legacyResources);

      const refDomain = extractDomain(document.referrer);
      let matchIdx = legacyResources.findIndex(r => r.domain === refDomain);

      // If no referrer match, show all collapsed
      if (matchIdx >= 0) {
        toggle(matchIdx);
      }

      renderHeadersTable();
    });
  </script>
</body>
</html>
